name: Dependency Scan on Push or Merge

on:
  push:
    branches:
      - main  # or any branch you'd like to monitor
      - master
  pull_request:
    types:
      - closed
    branches:
      - main  # only trigger for PRs targeting the main branch
      - master

jobs:
  dependabot-scan:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout the repository
        uses: actions/checkout@v3

      # Step 1: Run Dependabot (you can also use an action to trigger security updates)
      - name: Set up Dependabot Security Scanning
        run: |
          echo "Running Dependabot scanning..."
          dependabot-core update # This assumes you have the necessary tools to trigger it.

      # Step 2: Check for outdated dependencies (optional)
      - name: Check for outdated dependencies (npm example)
        run: |
          npm outdated
        continue-on-error: true  # Optionally allow this step to fail if there are outdated deps
      
      # Step 3: Run your vulnerability scanner (e.g., for npm or python)
      - name: Run Dependency Vulnerability Scan (npm example)
        run: |
          npm audit --audit-level=high
        continue-on-error: true  # Allow to continue even if vulnerabilities are found
